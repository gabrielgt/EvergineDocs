<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Custom Postprocessing graph | Evergine Doc </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Custom Postprocessing graph | Evergine Doc ">
    <meta name="generator" content="docfx 2.59.0.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container flex-container">
            <label for="version" class="select-label">Version:</label>
            <select id="select-version" class="select-version" name="version" title="version">
              <option value="4.0" class="option-version">4.0
              <option value="3.0" class="option-version">3.0
              <option value="2.0" class="option-version">2.0
              <option value="1.0" class="option-version">1.0
            </select>
            <div class="hide-when-search" id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="custom-postprocessing-graph">Custom Postprocessing graph</h1>

<hr>
<p>This section, it is explained how to create your custom postprocessing graph. This could be useful if you want to create and test effects that are not available in the default postprocessing graph.</p>
<h2 id="example">Example</h2>
<p>For this example, we are going to create a simple filter that renders only the red component of input render.</p>
<p>First, create a compute effect from the <a href="../../evergine_studio/interface.html"><strong>Assets Details panel</strong></a>:</p>
<p><img src="images/createComputeEffect.jpg" alt="Create a compute effect"></p>
<p>Write the code of our custom filter from <a href="../effects/effect_editor.html"><strong>Effect Editor</strong></a>:</p>
<pre><code class="lang-csharp"> [Begin_ResourceLayout]

    Texture2D input : register(t0);
    RWTexture2D&lt;float4&gt; Output : register(u0);

    SamplerState Sampler : register(s0);

[End_ResourceLayout]

[Begin_Pass:Default]

    [Profile 11_0]
    [Entrypoints CS = CS]

    [numthreads(8, 8, 1)]
    void CS(uint3 threadID : SV_DispatchThreadID)
    {
        float2 outputSize;
        Output.GetDimensions(outputSize.x, outputSize.y);
        float2 uv = (threadID.xy + 0.5) / outputSize;		

        float4 color = input.SampleLevel(Sampler, uv, 0);

        Output[threadID.xy] = float4(color.x,0,0,1);	
    }

[End_Pass]
</code></pre>
<p>Create a new Postprocessing graph asset from <a href="../../evergine_studio/interface.html"><strong>Assets Details panel</strong></a></p>
<p><img src="images/AssetsDetailsMenu.jpg" alt="Create postprocessing graph asset"></p>
<p>After creating the postprocessing graph asset make double click on the asset to open the Postprocessing Graph Editor. You can see an empty postprocessing graph where the render node connects directly with the Screen node.</p>
<p><img src="images/EmptyPostprocessingGraph.jpg" alt="Empty Postprocessing graph"></p>
<p>Drag our compute effect from the Available effects panel to the graph editor to create a new node. Then connect render node <em>Color texture</em> port with Custom node <em>Input</em> port and Custom node <em>Output</em> port with Screen node <em>Color Texture</em> port.</p>
<p><img src="images/customGraph.jpg" alt="Custom graph"></p>
<p>After saving the graph, you can see the result on the viewport panel.</p>
<p><img src="images/customGraphResult.jpg" alt="Custom Graph Result"></p>
<p>To use your custom postprocessing graph in your scene read more details in <a href="using_postprocessing_graphs.html">using postprocessing graph section</a></p>
<h2 id="special-nodes">Special Nodes</h2>
<p>There is a special Node named <em>Enable</em> that you can use to enable or disable an effect in your graph. Enable node has two inputs where input0 port connects with path without applying the effect and input1 port that connect with the path with the effect apply. Using its Enabled parameter you can select which path will be used by the output port. Everyone analyzes the graph before using and discard the no-used paths. For example, we are going to add this special node out before example.</p>
<p><img src="images/EnableNode.jpg" alt="Enable node"></p>
<h2 id="special-output-metatags">Special [Output] metatags</h2>
<p>There are special compute effect metatags used by the Postprocessing graph. The metatags <strong>Output</strong> could be used to define the output texture of any node. By default, the output texture is created using the first input texture information but you can configure it with Output metatags. With these special metatags, you can define the with, height, and pixel format of the node output texture.</p>
<p><strong>Output overloading</strong></p>
<p><span style="color:lightgreen">[Output(ReferencedInput)]</span></p>
<p><span style="color:lightgreen">[Output(ReferencedInput, ScaleFactor)]</span></p>
<p><span style="color:lightgreen">[Output(ReferencedInput, ScaleFactor, PixelFormat)]</span></p>
<p><span style="color:lightgreen">[Output(width, height, PixelFormat)]</span></p>
<p>The metatag parameters are:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ReferenceInput</strong></td>
<td>Input name used to get width, height and Pixel format of the output texture.</td>
</tr>
<tr>
<td><strong>ScaleFactor</strong></td>
<td>Defines the scale factor apply to the width and height of the ReferenceInput to get the output width and height dimensions.</td>
</tr>
<tr>
<td><strong>PixelFormat</strong></td>
<td>Defines the pixel format of the output texture.</td>
</tr>
<tr>
<td><strong>Width</strong></td>
<td>Defines the width dimension of the output texture.</td>
</tr>
<tr>
<td><strong>Height</strong></td>
<td>Defines the height dimension of the output texture.</td>
</tr>
</tbody>
</table>
<h3 id="example-1">Example</h3>
<p>In the following example the Depth input texture has <em>1920x1080</em> dimension and <em>D24_UNorm_S8_UInt</em> pixel format.</p>
<pre><code class="lang-csharp">Texture2D&lt;float&gt; Depth : register(t0);

RWTexture2D&lt;float4&gt; PositionOutput : register(u0);   [Output(Depth, 1, R16G16B16A16_Float)]
RWTexture2D&lt;float2&gt; VelocityOutput : register(u1);   [Output(Depth, 0.5, R16G16_Float)]
RWTexture2D&lt;float&gt; LinealDepthOutput : register(u2); [Output(500, 500, R32_Float)]
</code></pre>
<p>The result of the resolve the output tags will be:</p>
<table>
<thead>
<tr>
<th>Output Texture</th>
<th>Dimensions</th>
<th>Pixel Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>PositionOutput</td>
<td>1920x1080</td>
<td>R16G16B16A16_Float</td>
</tr>
<tr>
<td>VelocityOutput</td>
<td>960x540</td>
<td>R16G16_Float</td>
</tr>
<tr>
<td>LinealDepthOutput</td>
<td>500x500</td>
<td>R32_Float</td>
</tr>
</tbody>
</table>
<h2 id="postprocessing-graph-decorator">Postprocessing Graph Decorator</h2>
<p>You can create a c# class extending from <strong>PostProcessingGraphDecorator</strong> to define how your custom postprocessing graph is displayed on the PostProcessingGraphRenderer component. Only need to implement the GenerateUI method using the Editor extensions. More details about <a href="">here</a>.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
          
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <h5>In This Article</h5>
              <div></div>
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <div class="pull-left">
              
              <span>Generated by <strong>DocFX</strong></span>
            </div>      
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
